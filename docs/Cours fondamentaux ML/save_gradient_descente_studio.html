
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Optimisation des paramètres : &#8212; IA-Z</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IA-Z</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Sommaire
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apprentissage automatique
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="module_1_introduction/01%20-%20Pourquoi%20le%20ML%20%26%20information%20gr%C3%A2ce%20%C3%A0%20la%20data.html">
   Pourquoi le Machine Learning ?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/02%20-%20Elements%20de%20definition.html">
     Eléments de définition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/03%20-%20Regression%20lineaire.html">
     Introduction à la régression : la régression linéaire
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/05%20-%20Generalisation.html">
     Généralisation d’un modèle de Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/06%20-%20R%C3%A9gularisation%20%26%20tradeoff%20biais-variance%20-%20une%20introduction.html">
     Régularisation &amp; tradeoff biais-variance : une introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/07%20-%20R%C3%A9gularisation%20d%27un%20mod%C3%A8le.html">
     Régularisation d’un modèle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/08%20-%20Compromis%20biais-variance.html">
     Compromis biais-variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="module_1_introduction/11%20-%20Feature%20engineering%20%26%20cleaning.html">
     Feature Engineering
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Traitement automatique de la langue
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../NLP/chapitre1_introduction/1_Introduction.html">
   Chapitre I: Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../NLP/chapitre1_introduction/2_DonneesTextuelles.html">
     Etude des données textuelles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../NLP/chapitre2_notionsgenerales/3_ModStatLangage.html">
   Chapitre II: Notions générales
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../NLP/chapitre2_notionsgenerales/4_ModLangues.html">
     Modèles de langues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NLP/chapitre2_notionsgenerales/5_Embedings.html">
     Embeddings
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Vision par ordinateur
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/0_intro.html">
   Computer Vision
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/1_Image_processing.html">
   Section 1 Image processing techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/2_ML_CV.html">
   Machine Learning for Computer Vision
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/3_CNN.html">
   Convolutional Neural Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/4_Modern_CNN.html">
   Modern Convolutional Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours_CV/5_CV_tasks.html">
   Computer Vision tasks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apprentissage par renforcement
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours%20RL/1%20-%20Introduction.html">
   Introduction au Reinforcement learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours%20RL/3%20-%20Processus%20de%20d%C3%A9cision%20markoviens.html">
   Processus de décision markoviens (MDPs)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hors-série
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Cours%20annexes/mener_une_recherche.html">
   Mener une recherche internet efficacement
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/docs/Cours fondamentaux ML/save_gradient_descente_studio.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ia-z/ia-z"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ia-z/ia-z/issues/new?title=Issue%20on%20page%20%2Fdocs/Cours fondamentaux ML/save_gradient_descente_studio.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ia-z/ia-z/master?urlpath=tree/docs/Cours fondamentaux ML/save_gradient_descente_studio.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Optimisation des paramètres :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calcul-du-gradient">
   Calcul du gradient :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strategie-d-optimisation">
   Stratégie d’optimisation :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synthese-des-calculs">
   Synthèse des calculs :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme">
   Algorithme :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#le-dataset">
   Le dataset :
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notre-objet-d-etude">
     Notre objet d’étude :
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyse-rapide-des-donnees">
     Analyse rapide des données :
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition-des-fonctions">
   Définition des fonctions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Optimisation des paramètres
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-des-resultats">
   Analyse des résultats :
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Optimisation des paramètres :</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Optimisation des paramètres :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calcul-du-gradient">
   Calcul du gradient :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strategie-d-optimisation">
   Stratégie d’optimisation :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synthese-des-calculs">
   Synthèse des calculs :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme">
   Algorithme :
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#le-dataset">
   Le dataset :
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notre-objet-d-etude">
     Notre objet d’étude :
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyse-rapide-des-donnees">
     Analyse rapide des données :
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition-des-fonctions">
   Définition des fonctions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Optimisation des paramètres
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-des-resultats">
   Analyse des résultats :
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="optimisation-des-parametres">
<h1>Optimisation des paramètres :<a class="headerlink" href="#optimisation-des-parametres" title="Permalink to this headline">¶</a></h1>
<p><em>Encore une fois, il existe plusieurs manières de calculer les paramètres optimaux d’une régression linéaire et il serait difficile de toutes les lister. Nous allons donc traiter ici de la technique la plus commune</em></p>
<p>Le but de l’optimisation est de modifier les paramètres du modèle pour minimiser l’erreur. Nous allons pour cela utiliser l’outil gradient.</p>
<p>Pour rappel on appel le gradient d’une fonction à n variables est l’application qui associe à f un vecteur dont les composantes sont les dérivées partielles par rapport à chacune des variables de f :
<br><br>
<span class="math notranslate nohighlight">\(
\nabla f(\left.x_{1}, x_{2}, \ldots, x_{n}\right)=\left[\begin{array}{c}
\dfrac{\partial f}{\partial x_1} \\
\dfrac{\partial f}{\partial x_2} \\
\vdots \\
\dfrac{\partial f}{\partial x_n}
\end{array}\right]
\)</span></p>
<br>
<p>Calculer le gradient de notre fonction coût va nous renseigner sur ses variations et fournira des des informations sur la manière dont on doit faire varier les paramètres pour minimiser l’erreur.</p>
</div>
<div class="section" id="calcul-du-gradient">
<h1>Calcul du gradient :<a class="headerlink" href="#calcul-du-gradient" title="Permalink to this headline">¶</a></h1>
<p>Dans cette section, nous allons calculer ensemble le gradient de la fonction coût. Si vous êtes adepte des maths, et que vous voulez une démonstration pas à pas, je vous invite à aller voir la <a class="reference external" href="https://www.youtube.com/watch?v=wg7-roETbbM">vidéo de MachinLearnIA</a> qui sert de base à ce chapitre.</p>
<p>Rappelons ce qui a été établi plus haut:</p>
<ul class="simple">
<li><p>Le modèle <span class="math notranslate nohighlight">\(ŷ_i = a \times x_i + b\)</span></p></li>
<li><p>La fonction coût <span class="math notranslate nohighlight">\(S(y,ŷ) = \frac{1}{2m} * \sum_{i=0}^m (ŷ_i - y_i)²\)</span></p></li>
</ul>
<p>Calculons les dérivées partielles de S par rapport aux paramètres a et b: <br>
<span class="math notranslate nohighlight">\(\frac{\partial S}{\partial a} = \sum_{i=0}^m x_i \times (ŷ_i - y_i)\)</span> <br>
<span class="math notranslate nohighlight">\(\frac{\partial S}{\partial b} = \sum_{i=0}^m (ŷ_i - y_i)\)</span></p>
<p>On peut remarquer qu’en posant :</p>
<p><span class="math notranslate nohighlight">\(X = \left[\begin{array}{c}{x_1\\
\vdots\\x_m} {1 \\ \vdots \\ 1}\end{array} \right]\)</span></p>
<p><span class="math notranslate nohighlight">\(Y =  \left[\begin{array}{c}
{y_1\\ \vdots \\ y_m}\end{array}\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(\Theta =  \left[\begin{array}{c}
{a \\ b}\end{array}\right]\)</span></p>
<p>On a alors :
<span class="math notranslate nohighlight">\(∇S = \frac{1}{m} \times ^tX \times (X\Theta - Y)\)</span></p>
</div>
<div class="section" id="strategie-d-optimisation">
<h1>Stratégie d’optimisation :<a class="headerlink" href="#strategie-d-optimisation" title="Permalink to this headline">¶</a></h1>
<p>Pour optimiser le modèle, l’idée est de réaliser un certain nombre d’itérations au cours desquelles nous allons modifier légèrement les paramètres a et b. Pour cela, à chaque itération, on calcule la nouvelle valeur de <span class="math notranslate nohighlight">\(\Theta\)</span> de la manière suivante :
<span class="math notranslate nohighlight">\(\Theta ' = \Theta - \alpha \times ∇S\)</span></p>
<p>On pourrait avoir envie de retrancher simplement le gradient au vecteur <span class="math notranslate nohighlight">\(\Theta\)</span> mais dans certains cas, si la variation de S est trop importante, on pourrait se retrouver dans l’impossibilité de converger :</p>
<p>– Insérer animations explicatives sur gradient trop grand –</p>
<p>Pour résoudre ce problème, nous allons ajouter l’<strong>hyperparamètre</strong> <span class="math notranslate nohighlight">\(\alpha\)</span> à notre modèle. On l’appelle le <code class="docutils literal notranslate"><span class="pre">learning</span> <span class="pre">rate</span></code> et c’est un simple coefficient qui permet de pondérer le gradient lors du calcul de <span class="math notranslate nohighlight">\(\Theta\)</span> pour limiter la valeur du gradient. Nous ne traiterons pas plus de cet hyperparmamètre ici, cela sera traité dans le prochain chapitre.</p>
</div>
<div class="section" id="synthese-des-calculs">
<h1>Synthèse des calculs :<a class="headerlink" href="#synthese-des-calculs" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>On a choisi un modèle de droite affine :  <span class="math notranslate nohighlight">\(ŷ_i= a x_i+ b\)</span></p></li>
<li><p>On a choisi d’utiliser la fonction coût MSE qui s’écrit donc : <span class="math notranslate nohighlight">\(S(y,ŷ) = \frac{1}{2m} * \sum_{i=0}^m (ŷ_i - y_i)²\)</span></p></li>
<li><p>On utilise l’algorithme de descente de gradient pour optimiser les paramètres avec cette formule : <span class="math notranslate nohighlight">\(\Theta ' = \Theta - \alpha \times ∇S\)</span></p></li>
</ul>
<p>Pour pouvoir calculer tout cela il nous faut définir 3 matrices :</p>
<ul class="simple">
<li><p>X  : Une matrice qui contient les <strong>données explicatives</strong> (m données discrètes)</p></li>
<li><p>Y  : Une matrice qui contient les** données expliquées** tirées du dataset (m données discrètes). Ces données serviront à calibrer le modèle</p></li>
<li><p><span class="math notranslate nohighlight">\(\Theta\)</span> : La matrice qui contient les <strong>paramètres du modèle</strong>. Les paramètres pourront être initialisés aléatoirement ou arbitrairement (exemple : a = 0 et b = 0)</p></li>
</ul>
</div>
<div class="section" id="algorithme">
<h1>Algorithme :<a class="headerlink" href="#algorithme" title="Permalink to this headline">¶</a></h1>
<p>Voici donc l’algorithme que je vous propose d’utiliser pour réaliser une régression linéaire simple :</p>
<blockquote>
<div><p>Début</p>
</div></blockquote>
<blockquote>
<div><p>Importer/charger les données à traiter</p>
</div></blockquote>
<blockquote>
<div><p>Initialiser les 3 matrices X, Y, et <span class="math notranslate nohighlight">\(\Theta\)</span></p>
</div></blockquote>
<blockquote>
<div><p>Définir la fonction gradient</p>
</div></blockquote>
<blockquote>
<div><p>Faire n fois : <br>
 Retrancher à <span class="math notranslate nohighlight">\(\Theta\)</span> le produit du learning rate, de X et de <span class="math notranslate nohighlight">\(\Theta\)</span></p>
</div></blockquote>
<blockquote>
<div><p>Fin</p>
</div></blockquote>
<p>A ce stade, les paramètres ont été optimisés, ils peuvent être utilisés pour définir le modèle de droite affine qui servira à modéliser les données.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_diabetes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="le-dataset">
<h1>Le dataset :<a class="headerlink" href="#le-dataset" title="Permalink to this headline">¶</a></h1>
<p>J’ai choisi d’utiliser un dataset qui est intégré dans la librairie Sklearn. L’objectif ici n’est pas d’apprendre à utiliser cette librairie, mais sachez tout de même qu’il s’agit d’une librairie python qui regroupe un très grand nombre de modèles de machine learning et quelques dataset.
Le jeu de données choisi regroupe des données médicales de 420 personnes. Nous ne nous attarderons pas sur le contenu du jeu pour nous focaliser sur la mise en application d’une régression linéaire simple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Chargement du dataset</span>
<span class="n">data</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">load_diabetes</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1"># Résumé des données</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>bp</th>
      <th>s1</th>
      <th>s2</th>
      <th>s3</th>
      <th>s4</th>
      <th>s5</th>
      <th>s6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
      <td>4.420000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-2.511817e-19</td>
      <td>1.230790e-17</td>
      <td>-2.245564e-16</td>
      <td>-4.797570e-17</td>
      <td>-1.381499e-17</td>
      <td>3.918434e-17</td>
      <td>-5.777179e-18</td>
      <td>-9.042540e-18</td>
      <td>9.293722e-17</td>
      <td>1.130318e-17</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
      <td>4.761905e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.072256e-01</td>
      <td>-4.464164e-02</td>
      <td>-9.027530e-02</td>
      <td>-1.123988e-01</td>
      <td>-1.267807e-01</td>
      <td>-1.156131e-01</td>
      <td>-1.023071e-01</td>
      <td>-7.639450e-02</td>
      <td>-1.260971e-01</td>
      <td>-1.377672e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-3.729927e-02</td>
      <td>-4.464164e-02</td>
      <td>-3.422907e-02</td>
      <td>-3.665608e-02</td>
      <td>-3.424784e-02</td>
      <td>-3.035840e-02</td>
      <td>-3.511716e-02</td>
      <td>-3.949338e-02</td>
      <td>-3.324559e-02</td>
      <td>-3.317903e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.383060e-03</td>
      <td>-4.464164e-02</td>
      <td>-7.283766e-03</td>
      <td>-5.670422e-03</td>
      <td>-4.320866e-03</td>
      <td>-3.819065e-03</td>
      <td>-6.584468e-03</td>
      <td>-2.592262e-03</td>
      <td>-1.947171e-03</td>
      <td>-1.077698e-03</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.807591e-02</td>
      <td>5.068012e-02</td>
      <td>3.124802e-02</td>
      <td>3.564379e-02</td>
      <td>2.835801e-02</td>
      <td>2.984439e-02</td>
      <td>2.931150e-02</td>
      <td>3.430886e-02</td>
      <td>3.243232e-02</td>
      <td>2.791705e-02</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.107267e-01</td>
      <td>5.068012e-02</td>
      <td>1.705552e-01</td>
      <td>1.320436e-01</td>
      <td>1.539137e-01</td>
      <td>1.987880e-01</td>
      <td>1.811791e-01</td>
      <td>1.852344e-01</td>
      <td>1.335973e-01</td>
      <td>1.356118e-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="notre-objet-d-etude">
<h2>Notre objet d’étude :<a class="headerlink" href="#notre-objet-d-etude" title="Permalink to this headline">¶</a></h2>
<p>Je vous propose de travailler sur le lien entre l’age de la personne et sa mesure s6. On sélectionne donc les 2 colonnes du dataframe importé [–insérer lien vers indexage avec panda–]
On commence par tracer les points de données avec l’âge en abscisses et la mesure s6 en ordonnées.
On obtient le nuage de points suivant</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sélection des 2 colonnes de données</span>
<span class="n">age</span><span class="p">,</span> <span class="n">s6</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;s6&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">age</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">s6</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Tracé du nuage de point</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">s6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Age des personnes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;S6&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mesure de s6 en fonction de l&#39;âge du patient&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(442,) (442,)
</pre></div>
</div>
<img alt="../../_images/save_gradient_descente_studio_9_1.png" src="../../_images/save_gradient_descente_studio_9_1.png" />
</div>
</div>
</div>
<div class="section" id="analyse-rapide-des-donnees">
<h2>Analyse rapide des données :<a class="headerlink" href="#analyse-rapide-des-donnees" title="Permalink to this headline">¶</a></h2>
<p>On remarque qu’il se dégage une tendance dans ce nuage de ponts. Ils semblent s’aligner autour d’une droite de pente proche de 0.5 :
![données_avec_reg.png](data:image/png;base64,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)</p>
<p>Nous allons mettre en oeuvre un régression linéaire qui nous le confirmera.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Définition des matrices X, Y et Theta</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">age</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">age</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Ajout d&#39;une colonne de biais aux données</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s6</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Theta_init</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># On copie les paramètres initiaux pour comparer ensuite les modèles optimisé et initial</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X shape : &quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;  Y shape : &quot;</span><span class="p">,</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;Theta shape : &quot;</span><span class="p">,</span> <span class="n">Theta</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># Vérification des tailles de chaque matrice</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X shape :  (442, 2)   Y shape :  (442, 1) Theta shape :  (2, 1)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="definition-des-fonctions">
<h1>Définition des fonctions<a class="headerlink" href="#definition-des-fonctions" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implémenter le calcul  et de son gradient</span>
<span class="k">def</span> <span class="nf">grad</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Theta</span><span class="p">):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
  <span class="k">return</span>  <span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cost_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Theta</span><span class="p">):</span>
  <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
  <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>Optimisation des paramètres<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># Nombre d&#39;itérations de l&#39;optimisation</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># Learning rate : Pour régler la vitesse de convergence</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Cet historique permettra de tracer l&#39;évolution de l&#39;erreur du modèle au cours des itérations</span>

<span class="c1"># Apprentissage</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="n">Theta</span> <span class="o">-=</span> <span class="n">grad</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Theta</span><span class="p">)</span> <span class="c1"># Mise à jour des paramètres</span>
  <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Theta</span><span class="p">))</span> <span class="c1"># Enregistrement des paramètres dans l&#39;historique</span>

<span class="n">param_opti</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># On stocke les paramètres optimisés dans une variable</span>
<span class="n">Y_prediction</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="c1"># On calcul les points de la droite</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="analyse-des-resultats">
<h1>Analyse des résultats :<a class="headerlink" href="#analyse-des-resultats" title="Permalink to this headline">¶</a></h1>
<p>On vient d’entraîner notre modèle, voyons ce que nous obtenons. On va commencer par afficher l’évolution de l’erreur au cours de l’entraînement, puis nous afficherons les courbes obtenues ainsi que les paramètres calculés.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="p">)),</span> <span class="n">history</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Nombre de cycles d&#39;entrainement&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Erreur entre le modèle et les données&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evolution de l&#39;erreur au cours de l&#39;apprentissage avec un learning rate lr = </span><span class="si">{</span><span class="n">lr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/save_gradient_descente_studio_17_0.png" src="../../_images/save_gradient_descente_studio_17_0.png" />
</div>
</div>
<p>On voit que l’erreur converge bien vers un minimum. On peut jouer sur la valeur de <span class="math notranslate nohighlight">\(\alpha\)</span> pour ajuster la vitesse de convergence. Il faut cependant faire attention à ne pas utiliser de valeurs trop grandes qui empêcheraient la convergence !</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tracé des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span>  <span class="n">Y_prediction</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span>  <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Theta_init</span><span class="p">),</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">age</span><span class="p">,</span>  <span class="n">Y</span><span class="p">)</span>
<span class="c1"># Paramétrage du graphe</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mesure de s6 en fonction del&#39;âge du patient&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Age&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;s6&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Modèle optimisé&quot;</span><span class="p">,</span> <span class="s2">&quot;Modèle non optimisé&quot;</span><span class="p">,</span> <span class="s2">&quot;Données expérimentales&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">########### Paramètres ###########&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Paramètres initiaux : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Theta_init</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Paramètres optimisés : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">param_opti</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/save_gradient_descente_studio_19_0.png" src="../../_images/save_gradient_descente_studio_19_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>########### Paramètres ###########
Paramètres initiaux : 
 [[ 1.61863828]
 [-0.83427413]]
Paramètres optimisés : 
 [[4.38464628e-01]
 [1.07694145e-17]]
</pre></div>
</div>
</div>
</div>
<p>On voit bien ici que le modèle initial est totalement à côté de la plaque, mais c’est normal, car à ce stade les paramètres ont été définis aléatoirement. Cependant on remarque qu’après optimisation, le modèle est plutôt fidèle à la réalité et suit bien le nuage de points.</p>
<p>Notez que le nuage semble étiré par rapport aux graphes précédents, cela est du au changement d’échelle : les données ne descendent pas au dessous de -0.2 alors que le modèle initial a une ordonnées à l’origine de -0.8. Pour afficher tous les tracés sur la même figure matplotlib bibliothèque de tracés de graphes) a changé l’échelle.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/Cours fondamentaux ML"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Communauté IA-Z<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>